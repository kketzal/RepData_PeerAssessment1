---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

---
## **Loading and preprocessing the data**
  
### 1. Unzipping "activity.zip" file and reading the CSV file

```{r  echo=TRUE}
data <- read.csv(unzip("activity.zip"))
head(data)
```

  
### 2. Getting a new clean dataset without NA's values
```{r  echo=TRUE}
clean_data <- na.omit(data)
head(clean_data)
```

NOTE: *"na.omit()"* function add row names to the *"clean_data"* dataset. This names are the numeric index where NA's were located in the original dataset *"data"*.

## **What is mean total number of steps taken per day?**


For this part of the assignment, we can ignore the missing values in the dataset, so, we use *"clean_data"* dataset.

### 1. Calculate the total number of steps taken per day

```{r  echo=TRUE}
suppressPackageStartupMessages(library(dplyr))
total_steps_per_day <- summarise(group_by(clean_data,date), sum(steps))
colnames(total_steps_per_day) <- c("date", "totalSteps")
head(total_steps_per_day)
```


### 2. Make a histogram of the total number of steps taken each day

```{r  echo=TRUE}
suppressPackageStartupMessages(library(ggplot2))

p <- ggplot(total_steps_per_day, aes(x=date, y=totalSteps, fill=totalSteps))
p <- p + geom_histogram(stat='identity')
p <- p + scale_fill_gradient("Nº Steps", 
                             low = "green", 
                             high = "red")
p <- p + theme(text = element_text(size=10),axis.text.x = element_text(angle=90, vjust=1)) 
p <- p + xlab("Date")
p <- p + ylab("Total Number os Steps")
p <- p + ggtitle("Histogram - Total Number of Steps per Day")

print(p)
```

### 3. Calculate and report the mean and median total number of steps taken per day  


A. First we can calculate the MEAN value:
```{r  echo=TRUE}
mean(total_steps_per_day$totalSteps)
``` 

B. And then plot the MEAN as the blue dashed line:

```{r  echo=TRUE, message=FALSE}
suppressPackageStartupMessages(library(ggplot2))

p <- ggplot(total_steps_per_day, aes(x=date, y=totalSteps, fill=totalSteps))
p <- p + geom_histogram(stat='identity')
p <- p + scale_fill_gradient("Nº Steps", 
                             low = "green", 
                             high = "red")
p <- p + theme(text = element_text(size=10),axis.text.x = element_text(angle=90, vjust=1)) 
p <- p + xlab("Date")
p <- p + ylab("Total Number os Steps")
p <- p + ggtitle("Histogram - MEAN of total Number of Steps per Day")
p <- p + geom_hline(aes(yintercept=mean(totalSteps)), 
                    color="blue", 
                    linetype="dashed", 
                    size=0.5,
                    show_guide = TRUE) # "show_guide" is needed to show in legend 

# This 2 lines put the mean line in the legend or guide
 p <- p + geom_line(aes(color="Mean"), linetype="dashed")
 p <- p + scale_colour_manual(name="", values=c("Mean"= "blue"))


print(p)
```


C. First we can calculate the MEDIAN value:
```{r  echo=TRUE}
median(total_steps_per_day$totalSteps)
``` 

D. And then plot the MEDIAN as the green dashed line:

```{r  echo=TRUE, message=FALSE}
suppressPackageStartupMessages(library(ggplot2))

p <- ggplot(total_steps_per_day, aes(x=date, y=totalSteps, fill=totalSteps))
p <- p + geom_histogram(stat='identity')
p <- p + scale_fill_gradient("Nº Steps", 
                             low = "green", 
                             high = "red")
p <- p + theme(text = element_text(size=10),axis.text.x = element_text(angle=90, vjust=1)) 
p <- p + xlab("Date")
p <- p + ylab("Total Number os Steps")
p <- p + ggtitle("Histogram - MEDIAN of total Number of Steps per Day")
p <- p + geom_hline(aes(yintercept=mean(totalSteps)), 
                    color="green", 
                    linetype="dashed", 
                    size=0.5,
                    show_guide = TRUE) # "show_guide" is needed to show in legend

# This 2 lines put the mean line in the legend or guide
 p <- p + geom_line(aes(color="Median"), linetype="dashed")
 p <- p + scale_colour_manual(name="", values=c("Median"= "green"))

print(p)
```

NOTE: We use two different plots because the mean and median values are very similar. In this way, we can see the lines more clearly.

## **What is the average daily activity pattern?**
     
### 1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)  

```{r  echo=TRUE}
mean_steps_per_interval <- summarise(group_by(clean_data,interval), mean(steps))
colnames(mean_steps_per_interval) <- c("interval","meanSteps")
head(mean_steps_per_interval)
```

```{r  echo=TRUE}
plot(mean_steps_per_interval$interval, y = mean_steps_per_interval$meanSteps, type = "l")
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
